!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);function a(e){if(0===e)return"#000";var t=Math.round(130*e-80),n=Math.round(20+50*e);return e>.99&&(n+=30),`hsl(${t},100%,${n}%)`}var r=1024,i=null;var o=4096,s=null;var l=[30,40,50,80,100,105,110,150,160],c=l.map(e=>0);function u(e,t,n){for(var a=0,r=t;r<n;r++)if(e[r]<0&&a++,e[r]>0&&a>5)return r;return-1}var h=1024,v=null;var d=document.querySelector("#play"),f=document.querySelector("#viz"),m=new AudioContext,y=m.createGain();y.connect(m.destination),window.ctx=m,window.master=y;var p=[1,.4,.9,.5],g=["sine","square","triangle","sawtooth"].map((e,t)=>{var n=m.createOscillator();n.type=e;var a=m.createGain();n.connect(a),a.connect(y);var r=!1,i=p[t];return function(e){r||n.start(),r=!0;var t=m.currentTime;n.frequency.setValueAtTime(e,t),a.gain.cancelScheduledValues(t),a.gain.setValueAtTime(0,t),a.gain.linearRampToValueAtTime(i,t+.05),a.gain.linearRampToValueAtTime(.8*i,t+.1),a.gain.setTargetAtTime(0,t+.5,.1)}});function _(){x||m.resume(),x=!0;var e=200+2e3*Math.random()*Math.random(),t=Math.floor(g.length*Math.random());g[t](e)}var x=!1;function b(e){w.mode=e?e-1:(w.mode+1)%3}d.addEventListener("click",_),window.addEventListener("keydown",e=>{" "===e.key&&(_(),e.preventDefault())}),f.addEventListener("click",e=>b()),window.addEventListener("keydown",e=>{"1"===e.key&&b(1),"2"===e.key&&b(2),"3"===e.key&&b(3)});var w=new class{constructor(e,t,n,a,r){if(this.paused=!1,this.mode=r||0,this.minDb=-96,this.maxDb=-15,this.minFreq=150,this.maxFreq=15e3,this._ctx=e,this._canvasCtx=t.getContext("2d"),this._analyser=e.createAnalyser(),this._input=null,this._lastMode=-1,this.setInput(n),(a=a||30)>=60){var i=()=>{this.render(),requestAnimationFrame(i)};requestAnimationFrame(i)}else setInterval(()=>this.render(),1e3/a)}setInput(e){this._input&&this._input.disconnect(this._analyser),e.connect(this._analyser),this._input=e}render(){this.paused||"running"===this._ctx.state&&(0===this.mode&&function(e){var t=e._analyser,n=e._canvasCtx;t.fftSize=r;var o=t.frequencyBinCount;i||(i=new Uint8Array(o));t.getByteFrequencyData(i);var s=i;e.clear();for(var l=n.canvas.width,c=n.canvas.height,u=Math.log2(e.maxFreq),h=Math.log2(e.minFreq),v=e._ctx.sampleRate/2,d=t.frequencyBinCount,f=0;f<l;f++){var m=f/(l-1),y=Math.pow(2,h+m*(u-h)),p=Math.round(y/v*d),g=s[p]/255,_=g*c;n.fillStyle=a(g),n.fillRect(f,c-_,1,_)}}(this),1===this.mode&&function(e){var t=e._analyser,n=e._canvasCtx;t.fftSize=o,t.minDecibels=e.minDb,t.maxDecibels=e.maxDb;var r=t.frequencyBinCount;s||(s=new Float32Array(r));t.getFloatTimeDomainData(s);var i=s;e.clear();var h=n.canvas.width,v=n.canvas.height,d=function(e){var t=[],n=0;for(;t.length<8&&n>=0;)(n=u(e,n,e.length/2))>0&&t.push(n);if(t.length<2)return t[0]||0;n=0;var a=999999.9;return t.forEach(t=>{var r=function(e,t){return l.reduce((n,a,r)=>{var i=t[e+a];return n+Math.abs(i-c[r])},0)}(t,e);r>a||(a=.95*r-1,n=t)}),c=l.map(t=>e[t+n]),n}(i);n.lineWidth=2,n.beginPath(),n.moveTo(0,v/2);for(var f=r/2,m=0,y=0;y<f;y++){var p=y+d,g=p<r?s[p]:0;g>m&&(m=g);var _=h*y/f,x=v*(.5*(g+1));n.lineTo(_,v-x)}n.strokeStyle=a(Math.max(.2,m)),n.stroke()}(this),2===this.mode&&function(e,t){var n=e._analyser,r=e._canvasCtx;n.fftSize=h,n.smoothingTimeConstant=.3,n.minDecibels=e.minDb,n.maxDecibels=e.maxDb;var i=n.frequencyBinCount;v||(v=new Uint8Array(i));n.getByteFrequencyData(v);var o=v,s=r.canvas.width,l=r.canvas.height;t?(r.fillStyle=a(0),r.fillRect(0,0,s,l)):r.drawImage(r.canvas,-1,0,s,l);for(var c=Math.log2(e.maxFreq),u=Math.log2(e.minFreq),d=e._ctx.sampleRate/2,f=n.frequencyBinCount,m=0;m<l;m++){var y=(l-1-m)/(l-1),p=Math.pow(2,u+y*(c-u)),g=Math.round(p/d*f),_=o[g]/255;r.fillStyle=a(_),r.fillRect(s-1,m,1,1)}}(this,this.mode!==this._lastMode),this._lastMode=this.mode)}clear(e){var t=this._canvasCtx.canvas.width,n=this._canvasCtx.canvas.height;this._canvasCtx.fillStyle=e||a(0),this._canvasCtx.fillRect(0,0,t,n)}}(m,f,y,30,0);w.paused=!1}]);