!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){(function(e){!function e(t,n,a){function r(o,s){if(!n[o]){if(!t[o]){if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){var n=t[o][1][e];return r(n||e)}),c,c.exports,e,t,n,a)}return n[o].exports}for(var i=!1,o=0;o<a.length;o++)r(a[o]);return r}({1:[function(t,n,a){(function(e){"use strict";if(e.AnalyserNode&&!e.AnalyserNode.prototype.getFloatTimeDomainData){var t=new Uint8Array(2048);e.AnalyserNode.prototype.getFloatTimeDomainData=function(e){this.getByteTimeDomainData(t);for(var n=0,a=e.length;n<a;n++)e[n]=.0078125*(t[n]-128)}}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n(0);function a(e){if(0===e)return"#000";var t=Math.round(130*e-80),n=Math.round(20+50*e);return e>.99&&(n+=30),`hsl(${t},100%,${n}%)`}var r=null;var i=null;var o=[30,40,50,80,100,105,110,150,160],s=o.map(e=>0);function u(e,t,n){for(var a=0,r=t;r<n;r++)if(e[r]<0&&a++,e[r]>0&&a>5)return r;return-1}var c=null;var l="",f=!1,d=document.querySelector("#play"),h=document.querySelector("#viz"),v=new(window.AudioContext||window.webkitAudioContext),m=v.createGain();m.connect(v.destination),window.ctx=v,window.master=m;var y=[1,.4,.9,.5],p=["sine","square","triangle","sawtooth"].map((e,t)=>{var n=v.createOscillator();n.type=e;var a=v.createGain();n.connect(a),a.connect(m);var r=!1,i=y[t];return function(e){r||n.start(),r=!0;var t=v.currentTime;n.frequency.setValueAtTime(e,t),a.gain.cancelScheduledValues(t),a.gain.setValueAtTime(0,t),a.gain.linearRampToValueAtTime(i,t+.05),a.gain.linearRampToValueAtTime(.8*i,t+.1),a.gain.setTargetAtTime(0,t+.5,.1)}});function w(){g||v.resume(),g=!0;var e=200+2e3*Math.random()*Math.random(),t=Math.floor(p.length*Math.random());p[t](e)}var g=!1;function _(e){x.mode=e?e-1:(x.mode+1)%3}d.addEventListener("click",w),window.addEventListener("keydown",e=>{" "===e.key&&(w(),e.preventDefault()),"p"===e.key&&("running"===v.state?v.suspend():v.resume())}),h.addEventListener("click",e=>_()),window.addEventListener("keydown",e=>{"1"===e.key&&_(1),"2"===e.key&&_(2),"3"===e.key&&_(3)});var x=new class{constructor(e,t,n,a,r){if(this.paused=!1,this.mode=r||0,this.minDb=-96,this.maxDb=-15,this.minFreq=150,this.maxFreq=15e3,this._ctx=e,this._canvasCtx=t.getContext("2d"),this._analyser=e.createAnalyser(),this._input=null,this._lastMode=-1,this.setInput(n),(a=a||30)>=60){var i=()=>{this.render(),requestAnimationFrame(i)};requestAnimationFrame(i)}else setInterval(()=>this.render(),1e3/a)}setInput(e){this._input&&this._input.disconnect(this._analyser),e.connect(this._analyser),this._input=e}render(){(function(e){var t=e._ctx.state;l||(l=t);if(t===l)return;l=t,"suspended"===t&&(f=!0);if("running"===t&&f)return e._input.disconnect(e._analyser),e._analyser=e._ctx.createAnalyser(),e._input.connect(e._analyser),f=!1,!0})(this)||this.paused||"running"===this._ctx.state&&(0===this.mode&&function(e){var t=e._analyser,n=e._canvasCtx;t.fftSize=1024;var i=t.frequencyBinCount;r||(r=new Uint8Array(i));t.getByteFrequencyData(r);var o=r;e.clear();for(var s=n.canvas.width,u=n.canvas.height,c=Math.log2(e.maxFreq),l=Math.log2(e.minFreq),f=e._ctx.sampleRate/2,d=t.frequencyBinCount,h=0;h<s;h++){var v=h/(s-1),m=Math.pow(2,l+v*(c-l)),y=Math.round(m/f*d),p=o[y]/255,w=p*u;n.fillStyle=a(p),n.fillRect(h,u-w,1,w)}}(this),1===this.mode&&function(e){var t=e._analyser,n=e._canvasCtx;t.fftSize=4096,t.minDecibels=e.minDb,t.maxDecibels=e.maxDb;var r=t.frequencyBinCount;i||(i=new Float32Array(r));t.getFloatTimeDomainData(i);var c=i;e.clear();var l=n.canvas.width,f=n.canvas.height,d=function(e){var t=[],n=0;for(;t.length<8&&n>=0;)(n=u(e,n,e.length/2))>0&&t.push(n);if(t.length<2)return t[0]||0;n=0;var a=999999.9;return t.forEach(t=>{var r=function(e,t){return o.reduce((n,a,r)=>{var i=t[e+a];return n+Math.abs(i-s[r])},0)}(t,e);r>a||(a=.95*r-1,n=t)}),s=o.map(t=>e[t+n]),n}(c);n.lineWidth=2,n.beginPath(),n.moveTo(0,f/2);for(var h=r/2,v=0,m=0;m<h;m++){var y=m+d,p=y<r?i[y]:0;p>v&&(v=p);var w=l*m/h,g=f*(.5*(p+1));n.lineTo(w,f-g)}n.strokeStyle=a(Math.max(.2,v)),n.stroke()}(this),2===this.mode&&function(e,t){var n=e._analyser,r=e._canvasCtx;n.fftSize=1024,n.smoothingTimeConstant=.3,n.minDecibels=e.minDb,n.maxDecibels=e.maxDb;var i=n.frequencyBinCount;c||(c=new Uint8Array(i));n.getByteFrequencyData(c);var o=c,s=r.canvas.width,u=r.canvas.height;t?(r.fillStyle=a(0),r.fillRect(0,0,s,u)):r.drawImage(r.canvas,-1,0,s,u);for(var l=Math.log2(e.maxFreq),f=Math.log2(e.minFreq),d=e._ctx.sampleRate/2,h=n.frequencyBinCount,v=0;v<u;v++){var m=(u-1-v)/(u-1),y=Math.pow(2,f+m*(l-f)),p=Math.round(y/d*h),w=o[p]/255;r.fillStyle=a(w),r.fillRect(s-1,v,1,1)}}(this,this.mode!==this._lastMode),this._lastMode=this.mode)}clear(e){var t=this._canvasCtx.canvas.width,n=this._canvasCtx.canvas.height;this._canvasCtx.fillStyle=e||a(0),this._canvasCtx.fillRect(0,0,t,n)}}(v,h,m,30,0);x.paused=!1}]);